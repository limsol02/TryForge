<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.web.spring.chat.dao.ChatDao">

	<select id="getChatList" parameterType="int" resultType="chatList">
		SELECT cl.*
		FROM CHAT_MEMBER cm, CHAT_LIST cl 
		WHERE cm.MEMBER_KEY = #{memKey}
			AND cm.CHATLIST_KEY = cl.CHATLIST_KEY
		ORDER BY cl.LAST_TIME DESC
	</select>
	
	<select id="getChatMemList" parameterType="int" resultType="int">
		SELECT cm.member_key
		FROM CHAT_MEMBER cm
		WHERE cm.CHATLIST_KEY = #{listKey}
			AND cm.MEMBER_KEY != #{memKey}
	</select>
	
	<select id="getChat" parameterType="int" resultType="chat">
		SELECT *
		FROM chat
		WHERE CHATLIST_KEY = #{listKey}
		ORDER BY SEND_TIME
	</select>

</mapper>